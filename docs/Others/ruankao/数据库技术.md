# 数据库技术

---
数据库三级模式的模式、内模式、外模式分别对应基本表（表级）、存储文件（文件级）、视图（视图级）。

聚簇索引会将具体的物理存储改为顺序模式，所以属于内模式。

---
合并ER图

1. 属性冲突：属性域冲突和属性取值冲突（每个属性的取值范围对应一个值的集合，称为该属性的域）
2. 命名冲突：同名异义和异名同义
3. 接口冲突：同一对象在不同应用中具有不同的抽象，同一实体在不同局部ER图中所包含的属性格式和属性排序不完全相同

---
关系代数与元组演算

元组（tuple）是关系数据库中的基本概念，关系是一张表，表中的每行（即数据库中的每条记录）就是一个元组，每列就是一个属性。

运算：

- 并(∪)：结果为两者元组之和去除重复行
- 交(∩)：结果为两者元组的重复行
- 差(-)：结果为前者去除重复行
- 笛卡尔积(x)：结果列数为两者属性列之和，行数为两者元素数的乘积
- 投影(π：select)：对属性列的选择列出
- 选择(σ：where)：对元组行的选择列出
- 自然连接(⋈)：结果列为两者属性列数之和减去重复行，行数为两者同名属性列其值相同的结果元组

关系代数表达式查询优化的原则如下：

1. 尽早执行选取运算。
2. 合并乘积与其后的选择运算为连接运算。
3. 将投影运算与其后的其他运算同时进行，以避免重复扫描关系。
4. 将投影与其前后的二目运算结合起来，是的没有必要为去掉某些字段再扫描一遍关系。
5. 在执行连接前对关系适当地预处理，就能快速地找到要连接的元组。（方法有两种：索引连接法、排序合并连接法）
6. 存储公共子表达式。

---
规范化理论的意义：解决非规范化的关系模式中可能存在的问题：数据冗余、更新异常、插入异常、删除异常

---
事务的ACID特征

- 原子性（Atomicity）：事务是原子的，要么都做要么都不做。
- 一致性（Consistency）：在事务开始之前和事务结束以后，数据库的完整性没有被破坏。
- 隔离性（Isolation）：事务相互隔离。
- 持久性（Durability）：事务处理结束后，对数据的修改就是永久的。

---
数据库设计过程：

1. 需求分析：产出数据流图、数据字典、需求说明书
2. 概念结构设计(概念模型，E-R图)：将用户需求抽象为信息结构，产出E-R图
3. 逻辑结构设计(逻辑模式、外模式)：把基本E-R图转换为与选用数据库管理系统产品所支持的数据模型相符合的逻辑结构，产出关系模式
4. 物理设计(内模式):为一个给定的逻辑数据模型选取一个最适合应用要求的物理结构的过程，就是数据库的物理设计

---
DBMS（数据库管理系统）把事务开始、事务结束以及对数据库的插入、删除、修改的每一次操作写入日志文件，按一定时间间隔，把数据缓存区的内容写入数据文件。

DBMS的安全措施有3个方面：权限机制，视图机制，数据加密

---
排它锁：Exclusive Locks，简称X锁，又称写锁。事务A对数据上X锁，就只有A能读写数据，其他事务均不能加任何锁，从而不能读写数据直到A释放X锁。

共享锁：Share Locks，简称S锁，又称读锁。事务A对数据上S锁，A就只能读取数据而不能修改，其他事务也能对数据上S锁来读取，但是只要数据上有S锁，任何事务都只能对其加S锁而不能加X锁。

---
设U是关系模式R的属性集，F是R上成立的致设计U中属性的行数以依赖集。行数以来的推理规则有以下三条：

- 自反律：若属性集Y包含于属性集X，属性集X包含于U，则X→Y在R上成立（此处X→Y是平凡函数依赖）。
- 增广律：若X→Y在R上成立，且属性集Z包含于属性集U，则XZ→YZ在R上成立。
- 传递律：若X→Y和Y→Z在R上成立，则X→Z上成立。

根据异常三条推理规则，可得出以下三条推理规则：

- 合并规则：若X→Y，X→Z，则X→YZ为F所蕴含
- 伪传递规则：若X→Y，WY→Z，则XW→Z为F所蕴含
- 分解规则：若X→Y，Z⊆Y，则X→Z为F所蕴含

---
分布式数据库

- 分片透明性：用户不必关心数据是如何分片的，他们对数据的操作在全局关系上进行的，即关心如何分片对用户是透明的，因此，当分片改变时应用程序可以不变。分片透明是最高层次的透明性。
- 复制透明性：用户不关心数据库在网络中的各个节点的复制情况，被复制的数据更新都由系统自动完成。
- 位置透明性：用户不必知道所操作的数据放在何处，即数据分配到那个或那些站点存储对用户是透明的。因此，数据分片模式的改变，如把数据从一个站点转移到另一个站点将不会影响应用程序，因此应用程序不必改写。
- 逻辑透明性(局部映像透明性)：最低层次的透明性，该透明性提供数据到局部数据库的映像，即用户不必关心局部DBMS支持哪种数据模型、使用哪种数据操纵语言，数据模型和操纵语言的转换是由系统完成的。因此，局部映像透明性对异构型和同构异质的分布式数据库系统时非常重要。
