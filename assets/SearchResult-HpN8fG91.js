import{u as U,i as te,j as se,k as $,l as ae,P as oe,t as ne,n as le,p as V,q as T,s as re,v as z,x as s,y as ie,R as O,z as ce,A as ue,B as de,C as me,D as he,E as ve,G as ye,H as pe,I as ge,J as k,K as Ce,L as fe,M as Se,N as I,O as M,Q as Qe}from"./app-De7shokQ.js";const Pe=["/","/docs/","/docs/intro.html","/docs/essay/SlowSlowSong.html","/docs/essay/TearsOfRouge.html","/docs/essay/","/docs/essay/love.html","/docs/essay/me.html","/docs/essay/rain.html","/docs/links/","/docs/note/QCCSTP/","/docs/note/back-end/","/docs/note/design/","/docs/note/front-end/","/docs/note/tools/git.html","/docs/note/tools/gradle.html","/docs/note/tools/idea.html","/docs/note/tools/","/docs/note/tools/maven.html","/docs/note/tools/shell.html","/docs/note/tools/vs-code.html","/docs/series/games/","/docs/series/step-by-step/","/docs/series/step-by-step/java-installation-and-configuration.html","/docs/series/step-by-step/quickly-build-personal-documents.html","/docs/note/QCCSTP/software-design-engineer/algorithms-and-data-structures.html","/docs/note/QCCSTP/software-design-engineer/basic-knowledge-of-network-and-multimedia.html","/docs/note/QCCSTP/software-design-engineer/computer-composition-and-structure.html","/docs/note/QCCSTP/software-design-engineer/database-technology.html","/docs/note/QCCSTP/software-design-engineer/fundamentals-of-software-engineering.html","/docs/note/QCCSTP/software-design-engineer/","/docs/note/QCCSTP/software-design-engineer/object-oriented-technology.html","/docs/note/QCCSTP/software-design-engineer/operating-system.html","/docs/note/QCCSTP/software-design-engineer/program-language.html","/docs/note/QCCSTP/software-design-engineer/standardization-and-intellectual-property.html","/docs/note/QCCSTP/software-design-engineer/system-development-and-operation.html","/docs/note/QCCSTP/system-architect/case-analysis.html","/docs/note/QCCSTP/system-architect/computer-composition-and-architecture.html","/docs/note/QCCSTP/system-architect/computer-network.html","/docs/note/QCCSTP/system-architect/database-system.html","/docs/note/QCCSTP/system-architect/design-thesis.html","/docs/note/QCCSTP/system-architect/enterprise-informatization-strategy-and-implementation.html","/docs/note/QCCSTP/system-architect/","/docs/note/QCCSTP/system-architect/intellectual-property-and-standardization.html","/docs/note/QCCSTP/system-architect/mathematics-and-economic-management.html","/docs/note/QCCSTP/system-architect/operating-system.html","/docs/note/QCCSTP/system-architect/project-management.html","/docs/note/QCCSTP/system-architect/software-architecture-design.html","/docs/note/QCCSTP/system-architect/software-engineering.html","/docs/note/QCCSTP/system-architect/system-configuration-and-performance-evaluation.html","/docs/note/QCCSTP/system-architect/system-reliability-analysis-and-design.html","/docs/note/QCCSTP/system-architect/system-security-analysis-and-design.html","/docs/note/back-end/java/Collection.html","/docs/note/back-end/java/Concurrent.html","/docs/note/back-end/java/JVM.html","/docs/note/back-end/java/Java_Basics.html","/docs/note/back-end/java/SPI.html","/docs/note/back-end/java/","/docs/note/back-end/spring/Spring_Basics.html","/docs/note/back-end/spring/","/docs/note/design/UML/UML.html","/docs/note/front-end/ES6/Promise.html","/docs/note/front-end/Vue2/Component.html","/docs/note/front-end/Vue2/Modules.html","/docs/note/front-end/Vue2/Runtime.html","/docs/note/front-end/Vue2/Slot.html","/docs/note/front-end/Vue2/Vue_CLI.html","/docs/note/front-end/Vue2/Vue_Router.html","/docs/note/front-end/Vue2/Vuex.html","/docs/note/front-end/Vue2/Webpack.html","/docs/note/front-end/Vue3/","/404.html","/category/","/tag/","/article/","/star/","/timeline/"],we="SEARCH_PRO_QUERY_HISTORY",g=U(we,[]),Te=()=>{const{queryHistoryCount:a}=k,o=a>0;return{enabled:o,queryHistory:g,addQueryHistory:n=>{o&&(g.value=Array.from(new Set([n,...g.value.slice(0,a-1)])))},removeQueryHistory:n=>{g.value=[...g.value.slice(0,n),...g.value.slice(n+1)]}}},D=a=>Pe[a.id]+("anchor"in a?`#${a.anchor}`:""),ke="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:F}=k,C=U(ke,[]),be=()=>{const a=F>0;return{enabled:a,resultHistory:C,addResultHistory:o=>{if(a){const n={link:D(o),display:o.display};"header"in o&&(n.header=o.header),C.value=[n,...C.value.slice(0,F-1)]}},removeResultHistory:o=>{C.value=[...C.value.slice(0,o),...C.value.slice(o+1)]}}},He=a=>{const o=me(),n=$(),b=he(),r=V(0),Q=T(()=>r.value>0),v=ve([]);return ye(()=>{const{search:y,terminate:H}=pe(),f=ge(u=>{const S=u.join(" "),{searchFilter:R=h=>h,splitWord:q,suggestionsFilter:E,...p}=o.value;S?(r.value+=1,y(u.join(" "),n.value,p).then(h=>R(h,S,n.value,b.value)).then(h=>{r.value-=1,v.value=h}).catch(h=>{console.warn(h),r.value-=1,r.value||(v.value=[])})):v.value=[]},k.searchDelay-k.suggestDelay);z([a,n],([u])=>f(u),{immediate:!0}),Ce(()=>{H()})}),{isSearching:Q,results:v}};var qe=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:o}){const n=se(),b=$(),r=ae(oe),{enabled:Q,addQueryHistory:v,queryHistory:y,removeQueryHistory:H}=Te(),{enabled:f,resultHistory:u,addResultHistory:S,removeResultHistory:R}=be(),q=Q||f,E=ne(a,"queries"),{results:p,isSearching:h}=He(E),l=le({isQuery:!0,index:0}),d=V(0),m=V(0),_=T(()=>q&&(y.value.length>0||u.value.length>0)),x=T(()=>p.value.length>0),j=T(()=>p.value[d.value]||null),B=()=>{const{isQuery:e,index:t}=l;t===0?(l.isQuery=!e,l.index=e?u.value.length-1:y.value.length-1):l.index=t-1},J=()=>{const{isQuery:e,index:t}=l;t===(e?y.value.length-1:u.value.length-1)?(l.isQuery=!e,l.index=0):l.index=t+1},Y=()=>{d.value=d.value>0?d.value-1:p.value.length-1,m.value=j.value.contents.length-1},G=()=>{d.value=d.value<p.value.length-1?d.value+1:0,m.value=0},K=()=>{m.value<j.value.contents.length-1?m.value+=1:G()},N=()=>{m.value>0?m.value-=1:Y()},L=e=>e.map(t=>Qe(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=fe[e.index]||"$content",[i,w=""]=Se(t)?t[b.value].split("$content"):t.split("$content");return e.display.map(c=>s("div",L([i,...c,w])))}return e.display.map(t=>s("div",L(t)))},P=()=>{d.value=0,m.value=0,o("updateQuery",""),o("close")},X=()=>Q?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},r.value.queryHistory),y.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:l.isQuery&&l.index===t}],onClick:()=>{o("updateQuery",e)}},[s(I,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:M,onClick:i=>{i.preventDefault(),i.stopPropagation(),H(t)}})]))])):null,Z=()=>f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},r.value.resultHistory),u.value.map((e,t)=>s(O,{to:e.link,class:["search-pro-result-item",{active:!l.isQuery&&l.index===t}],onClick:()=>{P()}},()=>[s(I,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(i=>L(i)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:M,onClick:i=>{i.preventDefault(),i.stopPropagation(),R(t)}})]))])):null;return re("keydown",e=>{if(a.isFocusing){if(x.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=j.value.contents[m.value];v(a.queries.join(" ")),S(t),n.push(D(t)),P()}}else if(f){if(e.key==="ArrowUp")B();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:t}=l;l.isQuery?(o("updateQuery",y.value[t]),e.preventDefault()):(n.push(u.value[t].link),P())}}}}),z([d,m],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!x.value:!_.value}],id:"search-pro-results"},a.queries.length?h.value?s(ie,{hint:r.value.searching}):x.value?s("ul",{class:"search-pro-result-list"},p.value.map(({title:e,contents:t},i)=>{const w=d.value===i;return s("li",{class:["search-pro-result-list-item",{active:w}]},[s("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((c,ee)=>{const A=w&&m.value===ee;return s(O,{to:D(c),class:["search-pro-result-item",{active:A,"aria-selected":A}],onClick:()=>{v(a.queries.join(" ")),S(c),P()}},()=>[c.type==="text"?null:s(c.type==="title"?ce:c.type==="heading"?ue:de,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[c.type==="text"&&c.header?s("div",{class:"content-header"},c.header):null,s("div",W(c))])])})])})):r.value.emptyResult:q?_.value?[X(),Z()]:r.value.emptyHistory:r.value.emptyResult)}});export{qe as default};
