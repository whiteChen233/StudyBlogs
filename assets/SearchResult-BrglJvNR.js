import{u as O,i as Z,j as ee,k as U,l as te,n as se,t as ae,p as oe,q as D,s as V,v as ne,x as z,y as s,z as le,R as $,A as re,B as ie,C as ce,D as F,E as I,G as ue,H as de,I as me,J as he,O as ve,K as ye,L as pe,P as ge,M as Ce,N as fe,Q as k}from"./app-lwATv0Qq.js";const Qe=["/","/docs/","/docs/intro.html","/docs/essay/SlowSlowSong.html","/docs/essay/TearsOfRouge.html","/docs/essay/","/docs/essay/love.html","/docs/essay/me.html","/docs/essay/rain.html","/docs/links/","/docs/note/QCCSTP/","/docs/note/back-end/","/docs/note/design/","/docs/note/front-end/","/docs/note/tools/git.html","/docs/note/tools/gradle.html","/docs/note/tools/idea.html","/docs/note/tools/","/docs/note/tools/maven.html","/docs/note/tools/shell.html","/docs/note/tools/vs-code.html","/docs/series/games/","/docs/series/step-by-step/","/docs/series/step-by-step/java-installation-and-configuration.html","/docs/series/step-by-step/quickly-build-personal-documents.html","/docs/note/QCCSTP/software-design-engineer/algorithms-and-data-structures.html","/docs/note/QCCSTP/software-design-engineer/basic-knowledge-of-network-and-multimedia.html","/docs/note/QCCSTP/software-design-engineer/computer-composition-and-structure.html","/docs/note/QCCSTP/software-design-engineer/database-technology.html","/docs/note/QCCSTP/software-design-engineer/fundamentals-of-software-engineering.html","/docs/note/QCCSTP/software-design-engineer/","/docs/note/QCCSTP/software-design-engineer/object-oriented-technology.html","/docs/note/QCCSTP/software-design-engineer/operating-system.html","/docs/note/QCCSTP/software-design-engineer/program-language.html","/docs/note/QCCSTP/software-design-engineer/standardization-and-intellectual-property.html","/docs/note/QCCSTP/software-design-engineer/system-development-and-operation.html","/docs/note/QCCSTP/system-architect/case-analysis.html","/docs/note/QCCSTP/system-architect/computer-composition-and-architecture.html","/docs/note/QCCSTP/system-architect/computer-network.html","/docs/note/QCCSTP/system-architect/database-system.html","/docs/note/QCCSTP/system-architect/design-thesis.html","/docs/note/QCCSTP/system-architect/enterprise-informatization-strategy-and-implementation.html","/docs/note/QCCSTP/system-architect/","/docs/note/QCCSTP/system-architect/intellectual-property-and-standardization.html","/docs/note/QCCSTP/system-architect/mathematics-and-economic-management.html","/docs/note/QCCSTP/system-architect/operating-system.html","/docs/note/QCCSTP/system-architect/project-management.html","/docs/note/QCCSTP/system-architect/software-architecture-design.html","/docs/note/QCCSTP/system-architect/software-engineering.html","/docs/note/QCCSTP/system-architect/system-configuration-and-performance-evaluation.html","/docs/note/QCCSTP/system-architect/system-reliability-analysis-and-design.html","/docs/note/QCCSTP/system-architect/system-security-analysis-and-design.html","/docs/note/back-end/java/Collection.html","/docs/note/back-end/java/Concurrent.html","/docs/note/back-end/java/JVM.html","/docs/note/back-end/java/Java_Basics.html","/docs/note/back-end/java/SPI.html","/docs/note/back-end/java/","/docs/note/back-end/spring/Spring_Basics.html","/docs/note/back-end/spring/","/docs/note/design/UML/UML.html","/docs/note/front-end/ES6/Promise.html","/docs/note/front-end/Vue2/Component.html","/docs/note/front-end/Vue2/Modules.html","/docs/note/front-end/Vue2/Runtime.html","/docs/note/front-end/Vue2/Slot.html","/docs/note/front-end/Vue2/Vue_CLI.html","/docs/note/front-end/Vue2/Vue_Router.html","/docs/note/front-end/Vue2/Vuex.html","/docs/note/front-end/Vue2/Webpack.html","/docs/note/front-end/Vue3/","/404.html","/category/","/tag/","/article/","/star/","/timeline/"],Se="SEARCH_PRO_QUERY_HISTORY",v=O(Se,[]),Pe=()=>{const{queryHistoryCount:a}=k,o=a>0;return{enabled:o,queryHistory:v,addQueryHistory:n=>{o&&(v.value.length<a?v.value=Array.from(new Set([n,...v.value])):v.value=Array.from(new Set([n,...v.value.slice(0,a-1)])))},removeQueryHistory:n=>{v.value=[...v.value.slice(0,n),...v.value.slice(n+1)]}}},A=a=>Qe[a.id]+("anchor"in a?`#${a.anchor}`:""),Te="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:L}=k,y=O(Te,[]),we=()=>{const a=L>0;return{enabled:a,resultHistory:y,addResultHistory:o=>{if(a){const n={link:A(o),display:o.display};"header"in o&&(n.header=o.header),y.value.length<L?y.value=[n,...y.value]:y.value=[n,...y.value.slice(0,L-1)]}},removeResultHistory:o=>{y.value=[...y.value.slice(0,o),...y.value.slice(o+1)]}}},ke=a=>{const o=ue(),n=U(),b=de(),r=D(!1),C=me([]);return he(()=>{const{search:S,terminate:p}=ve(),P=()=>{C.value=[],r.value=!1},f=fe(u=>{const Q=u.join(" "),{searchFilter:H=h=>h,splitWord:R,suggestionsFilter:E,...g}=o.value;r.value=!0,Q?S(u.join(" "),n.value,g).then(h=>H(h,Q,n.value,b.value)).then(h=>{C.value=h,r.value=!1}).catch(h=>{console.error(h),P()}):P()},k.searchDelay-k.suggestDelay);z([a,n],([u])=>f(u),{immediate:!0}),ye(()=>{p()})}),{searching:r,results:C}};var He=Z({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:o}){const n=ee(),b=U(),r=te(se),{enabled:C,addQueryHistory:S,queryHistory:p,removeQueryHistory:P}=Pe(),{enabled:f,resultHistory:u,addResultHistory:Q,removeResultHistory:H}=we(),R=C||f,E=ae(a,"queries"),{results:g,searching:h}=ke(E),l=oe({isQuery:!0,index:0}),d=D(0),m=D(0),_=V(()=>R&&(p.value.length>0||u.value.length>0)),x=V(()=>g.value.length>0),q=V(()=>g.value[d.value]||null),B=()=>{const{isQuery:e,index:t}=l;t===0?(l.isQuery=!e,l.index=e?u.value.length-1:p.value.length-1):l.index=t-1},J=()=>{const{isQuery:e,index:t}=l;t===(e?p.value.length-1:u.value.length-1)?(l.isQuery=!e,l.index=0):l.index=t+1},Y=()=>{d.value=d.value>0?d.value-1:g.value.length-1,m.value=q.value.contents.length-1},G=()=>{d.value=d.value<g.value.length-1?d.value+1:0,m.value=0},K=()=>{m.value<q.value.contents.length-1?m.value+=1:G()},N=()=>{m.value>0?m.value-=1:Y()},j=e=>e.map(t=>pe(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=ge[e.index]||"$content",[i,w=""]=Ce(t)?t[b.value].split("$content"):t.split("$content");return e.display.map(c=>s("div",j([i,...c,w])))}return e.display.map(t=>s("div",j(t)))},T=()=>{d.value=0,m.value=0,o("updateQuery",""),o("close")};return ne("keydown",e=>{if(a.isFocusing){if(x.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=q.value.contents[m.value];S(a.queries.join(" ")),Q(t),n.push(A(t)),T()}}else if(f){if(e.key==="ArrowUp")B();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:t}=l;l.isQuery?(o("updateQuery",p.value[t]),e.preventDefault()):(n.push(u.value[t].link),T())}}}}),z([d,m],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!x.value:!_.value}],id:"search-pro-results"},a.queries.length?h.value?s(le,{hint:r.value.searching}):x.value?s("ul",{class:"search-pro-result-list"},g.value.map(({title:e,contents:t},i)=>{const w=d.value===i;return s("li",{class:["search-pro-result-list-item",{active:w}]},[s("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((c,X)=>{const M=w&&m.value===X;return s($,{to:A(c),class:["search-pro-result-item",{active:M,"aria-selected":M}],onClick:()=>{S(a.queries.join(" ")),Q(c),T()}},()=>[c.type==="text"?null:s(c.type==="title"?re:c.type==="heading"?ie:ce,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[c.type==="text"&&c.header?s("div",{class:"content-header"},c.header):null,s("div",W(c))])])})])})):r.value.emptyResult:R?_.value?[C?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},r.value.queryHistory),p.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:l.isQuery&&l.index===t}],onClick:()=>{o("updateQuery",e)}},[s(F,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),P(t)}})]))])):null,f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},r.value.resultHistory),u.value.map((e,t)=>s($,{to:e.link,class:["search-pro-result-item",{active:!l.isQuery&&l.index===t}],onClick:()=>{T()}},()=>[s(F,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(i=>j(i)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),H(t)}})]))])):null]:r.value.emptyHistory:r.value.emptyResult)}});export{He as default};
