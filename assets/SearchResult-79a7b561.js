import{u as F,b as A,W as M,c as Q,d as G,e as I,n as O,o as V,s as _,l as z,i as J,f as K,g as N,h as L,j as T,H as X,m as Y}from"./app-bdb9985b.js";import{c as Z,D as ee,I as ae,r as m,h as q,o as se,x as te,j as e,R as C,w as le,F as re,i as ue}from"./framework-7a00e1ec.js";import"./preload-helper-101896b7.js";const ne="search-pro-history-results",n=F(ne,[]),oe=()=>{const{historyCount:o}=L;return{history:n,addHistory:l=>{n.value.length<o?n.value=[l,...n.value]:n.value=[l,...n.value.slice(0,o-1)]},removeHistory:l=>{n.value=[...n.value.slice(0,l),...n.value.slice(l+1)]}}},ce=o=>{const l=A(),i=m(!1),d=m([]);let c;const v=N(p=>{i.value=!0,c==null||c.terminate(),p?(c=new Worker(`/${L.worker}`,{}),c.addEventListener("message",({data:g})=>{d.value=g,i.value=!1}),c.postMessage({query:p,routeLocale:l.value})):(d.value=[],i.value=!1)},L.delay);return le([o,l],()=>v(o.value),{immediate:!0}),{searching:i,results:d}};var he=Z({name:"SearchResult",props:{query:{type:String,required:!0}},emits:{close:()=>!0,updateQuery:o=>!0},setup(o,{emit:l}){const i=T(),d=ee(),c=A(),v=M(X),{history:p,addHistory:g,removeHistory:E}=oe(),$=ae(o,"query"),{results:y,searching:P}=ce($),r=m(0),t=m(0),S=m(),k=q(()=>y.value.length>0),R=q(()=>y.value[r.value]||null),j=()=>{r.value=r.value>0?r.value-1:y.value.length-1,t.value=R.value.contents.length-1},x=()=>{r.value=r.value<y.value.length-1?r.value+1:0,t.value=0},B=()=>{t.value<R.value.contents.length-1?t.value=t.value+1:x()},U=()=>{t.value>0?t.value=t.value-1:j()},H=a=>a.map(s=>ue(s)?s:e(s[0],s[1])),b=a=>{if(a.type==="custom"){const s=Y[a.index]||"$content",[h,f=""]=re(s)?s[c.value].split("$content"):s.split("$content");return H([h,...a.display,f])}return H(a.display)},w=()=>{r.value=0,t.value=0,l("updateQuery",""),l("close")};return se(()=>{Q("keydown",a=>{if(k.value){if(a.key==="ArrowUp")U();else if(a.key==="ArrowDown")B();else if(a.key==="Enter"){const s=R.value.contents[t.value];i.value.path!==s.path&&(g(s),d.push(s.path),w())}}}),G(S.value,{reserveScrollBarGap:!0})}),te(()=>{I()}),()=>e("div",{class:["search-pro-result",{empty:$.value===""?p.value.length===0:!k.value}],ref:S},$.value===""?p.value.length?e("ul",{class:"search-pro-result-list"},e("li",{class:"search-pro-result-list-item"},[e("div",{class:"search-pro-result-title"},v.value.history),p.value.map((a,s)=>e(C,{to:a.path,class:["search-pro-result-item",{active:t.value===s}],onClick:()=>{w()}},()=>[e(O,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[a.type==="content"&&a.header?e("div",{class:"content-header"},a.header):null,e("div",b(a))]),e("button",{class:"search-pro-close-icon",onClick:h=>{h.preventDefault(),h.stopPropagation(),E(s)}},e(V))]))])):v.value.emptyHistory:P.value?e(_,{hint:v.value.searching}):k.value?e("ul",{class:"search-pro-result-list"},y.value.map(({title:a,contents:s},h)=>{const f=r.value===h;return e("li",{class:["search-pro-result-list-item",{active:f}]},[e("div",{class:"search-pro-result-title"},a||"Documentation"),s.map((u,W)=>{const D=f&&t.value===W;return e(C,{to:u.path,class:["search-pro-result-item",{active:D,"aria-selected":D}],onClick:()=>{g(u),w()}},()=>[u.type==="content"?null:e(u.type==="title"?z:u.type==="heading"?J:K,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[u.type==="content"&&u.header?e("div",{class:"content-header"},u.header):null,e("div",b(u))])])})])})):v.value.emptyResult)}});export{he as default};
