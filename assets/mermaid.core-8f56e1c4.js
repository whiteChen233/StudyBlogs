import{l as o}from"./transform-49cadac7.js";import{i as w,u as y,r as S,l as P}from"./utils-3cbdbddf-32493294.js";import{m}from"./mermaidAPI-a1a81019-a12021ec.js";import"./setupGraphViewbox-e1099da8-0b41caab.js";import"./commonDb-7528607a-e660faf1.js";import"./preload-helper-101896b7.js";import"./errorRenderer-11917bdc-03fe838a.js";function D(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var n=Array.from(typeof e=="string"?[e]:e);n[n.length-1]=n[n.length-1].replace(/\r?\n([\t ]*)$/,"");var c=n.reduce(function(r,i){var d=i.match(/\n([\t ]+|(?!\s).)/g);return d?r.concat(d.map(function(p){var u,l;return(l=(u=p.match(/[\t ]/g))===null||u===void 0?void 0:u.length)!==null&&l!==void 0?l:0})):r},[]);if(c.length){var g=new RegExp(`
[	 ]{`+Math.min.apply(Math,c)+"}","g");n=n.map(function(r){return r.replace(g,`
`)})}n[0]=n[0].replace(/^\r?\n/,"");var s=n[0];return t.forEach(function(r,i){var d=s.match(/(?:^|\n)( *)$/),p=d?d[1]:"",u=r;typeof r=="string"&&r.includes(`
`)&&(u=String(r).split(`
`).map(function(l,O){return O===0?l:""+p+l}).join(`
`)),s+=u+n[i+1]}),s}const q=(e,t,a)=>{o.warn(e),w(e)?(a&&a(e.str,e.hash),t.push({...e,message:e.str,error:e})):(a&&a(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},E=async function(e={querySelector:".mermaid"}){try{await A(e)}catch(t){if(w(t)&&o.error(t.str),f.parseError&&f.parseError(t),!e.suppressErrors)throw o.error("Use the suppressErrors option to suppress these errors"),t}},A=async function({postRenderCallback:e,querySelector:t,nodes:a}={querySelector:".mermaid"}){const n=m.getConfig();o.debug(`${e?"":"No "}Callback function found`);let c;if(a)c=a;else if(t)c=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");o.debug(`Found ${c.length} diagrams`),(n==null?void 0:n.startOnLoad)!==void 0&&(o.debug("Start On Load: "+(n==null?void 0:n.startOnLoad)),m.updateSiteConfig({startOnLoad:n==null?void 0:n.startOnLoad}));const g=new y.initIdGenerator(n.deterministicIds,n.deterministicIDSeed);let s;const r=[];for(const i of Array.from(c)){o.info("Rendering diagram: "+i.id);/*! Check if previously processed */if(i.getAttribute("data-processed"))continue;i.setAttribute("data-processed","true");const d=`mermaid-${g.next()}`;s=i.innerHTML,s=D(y.entityDecode(s)).trim().replace(/<br\s*\/?>/gi,"<br/>");const p=y.detectInit(s);p&&o.debug("Detected early reinit: ",p);try{const{svg:u,bindFunctions:l}=await m.render(d,s,i);i.innerHTML=u,e&&await e(d),l&&l(i)}catch(u){q(u,r,f.parseError)}}if(r.length>0)throw r[0]},L=function(e){m.initialize(e)},M=async function(e,t,a){o.warn("mermaid.init is deprecated. Please use run instead."),e&&L(e);const n={postRenderCallback:a,querySelector:".mermaid"};typeof t=="string"?n.querySelector=t:t&&(t instanceof HTMLElement?n.nodes=[t]:n.nodes=t),await E(n)},C=async(e,{lazyLoad:t=!0}={})=>{S(...e),t===!1&&await P()},b=function(){if(f.startOnLoad){const{startOnLoad:e}=m.getConfig();e&&f.run().catch(t=>o.error("Mermaid failed to initialize",t))}};if(typeof document<"u"){/*!
 * Wait for document loaded before starting the execution
 */window.addEventListener("load",b,!1)}const I=function(e){f.parseError=e},h=[];let v=!1;const x=async()=>{if(!v){for(v=!0;h.length>0;){const e=h.shift();if(e)try{await e()}catch(t){o.error("Error executing queue",t)}}v=!1}},T=async(e,t)=>new Promise((a,n)=>{const c=()=>new Promise((g,s)=>{m.parse(e,t).then(r=>{g(r),a(r)},r=>{var i;o.error("Error parsing",r),(i=f.parseError)==null||i.call(f,r),s(r),n(r)})});h.push(c),x().catch(n)}),$=(e,t,a)=>new Promise((n,c)=>{const g=()=>new Promise((s,r)=>{m.render(e,t,a).then(i=>{s(i),n(i)},i=>{var d;o.error("Error parsing",i),(d=f.parseError)==null||d.call(f,i),r(i),c(i)})});h.push(g),x().catch(c)}),f={startOnLoad:!0,mermaidAPI:m,parse:T,render:$,init:M,run:E,registerExternalDiagrams:C,initialize:L,parseError:void 0,contentLoaded:b,setParseErrorHandler:I};export{f as default};
